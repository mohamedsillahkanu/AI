<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Facility Heatmap Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: #e1effe;
            background: linear-gradient(135deg, #0a0e1a 0%, #0f1629 25%, #1a237e 75%, #1565c0 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .demo-header {
            text-align: center;
            padding: 2rem 0;
            color: white;
            margin-bottom: 2rem;
        }

        .demo-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
        }

        .demo-container {
            max-width: 1600px;
            margin: 0 auto;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.95) 0%, rgba(30, 41, 59, 0.95) 100%);
            backdrop-filter: blur(15px);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(37, 99, 235, 0.2);
        }

        .chart-title {
            color: #93c5fd;
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 2rem;
            text-align: center;
        }

        .canvas-container {
            text-align: center;
            margin: 2rem 0;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            overflow-x: auto;
        }

        #demoCanvas {
            display: block;
            margin: 0 auto;
            border-radius: 8px;
        }

        .demo-info {
            margin-top: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.15) 0%, rgba(2, 132, 199, 0.15) 100%);
            border-left: 4px solid #0ea5e9;
            border-radius: 10px;
            color: #7dd3fc;
        }

        .demo-info h3 {
            margin-bottom: 1rem;
            color: #93c5fd;
        }

        .demo-info ul {
            margin-left: 1.5rem;
        }

        .demo-info li {
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="demo-header">
        <h1>Health Facility Heatmap Demo</h1>
        <p>Example visualization showing clear text and labels</p>
    </div>

    <div class="demo-container">
        <div class="chart-title">Regional Health Facility Reporting Status - Sample Data</div>
        
        <div class="canvas-container">
            <canvas id="demoCanvas"></canvas>
        </div>

        <div class="demo-info">
            <h3>Key Features Demonstrated:</h3>
            <ul>
                <li><strong>Clear Text Labels:</strong> District names and dates are clearly readable with appropriate font sizes</li>
                <li><strong>Color Legend:</strong> Shows reporting rate scale from 0% (red) to 100% (green)</li>
                <li><strong>Proper Spacing:</strong> Adequate margins and cell sizes for readability</li>
                <li><strong>Rotated Date Labels:</strong> Diagonal text prevents overlap for multiple time periods</li>
                <li><strong>Truncated Long Names:</strong> District names are shortened with "..." when too long</li>
                <li><strong>High Contrast:</strong> White background with dark text for maximum visibility</li>
                <li><strong>Grid Lines:</strong> Subtle grid lines help identify specific data points</li>
            </ul>
        </div>
    </div>

    <script>
        // Sample data for demonstration
        const sampleData = {
            region: "Sample Region",
            districts: [
                "District Alpha", "District Beta", "District Gamma", 
                "District Delta", "District Epsilon", "District Zeta",
                "District Eta", "District Theta", "District Iota",
                "District Kappa", "District Lambda", "District Mu"
            ],
            dates: [
                "2024-01", "2024-02", "2024-03", "2024-04", "2024-05", 
                "2024-06", "2024-07", "2024-08", "2024-09", "2024-10"
            ],
            // Random reporting rates for demonstration
            reportingRates: [
                [85, 92, 78, 88, 95, 82, 90, 87, 93, 89],
                [76, 84, 91, 79, 86, 94, 81, 88, 85, 92],
                [92, 88, 85, 93, 79, 87, 94, 82, 89, 86],
                [68, 75, 82, 89, 76, 84, 91, 78, 85, 92],
                [94, 87, 93, 85, 91, 88, 82, 95, 89, 86],
                [81, 89, 76, 84, 92, 85, 88, 91, 87, 94],
                [87, 82, 89, 95, 84, 91, 86, 88, 93, 85],
                [73, 86, 91, 82, 88, 94, 89, 85, 92, 87],
                [89, 93, 85, 91, 87, 82, 95, 88, 84, 90],
                [84, 88, 92, 86, 93, 89, 85, 91, 87, 82],
                [91, 85, 88, 93, 82, 87, 94, 89, 86, 91],
                [78, 92, 86, 89, 94, 85, 88, 92, 87, 93]
            ]
        };

        function generateDemoHeatmap() {
            const canvas = document.getElementById('demoCanvas');
            const ctx = canvas.getContext('2d');
            
            const { districts, dates, reportingRates } = sampleData;
            
            // Canvas dimensions
            const cellWidth = 60;
            const cellHeight = 35;
            const margins = {
                top: 120,
                bottom: 100,
                left: 200,
                right: 50
            };
            
            const heatmapWidth = cellWidth * dates.length;
            const heatmapHeight = cellHeight * districts.length;
            const canvasWidth = heatmapWidth + margins.left + margins.right;
            const canvasHeight = heatmapHeight + margins.top + margins.bottom;
            
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;
            canvas.style.width = canvasWidth + 'px';
            canvas.style.height = canvasHeight + 'px';
            
            // Clear canvas with white background
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);
            
            const startX = margins.left;
            const startY = margins.top;
            
            // Title
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 24px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Health Facility Reporting Rates by District', canvasWidth / 2, 35);
            
            // Subtitle
            ctx.fillStyle = '#64748b';
            ctx.font = '16px Arial';
            ctx.fillText('Sample Region - Monthly Data 2024', canvasWidth / 2, 60);
            
            // Draw legend
            drawLegend(ctx, canvasWidth / 2, 85);
            
            // Y-axis title
            ctx.save();
            ctx.translate(30, startY + heatmapHeight / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Districts', 0, 0);
            ctx.restore();
            
            // X-axis title
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Reporting Period (Month-Year)', startX + heatmapWidth / 2, canvasHeight - 20);
            
            // Draw heatmap cells
            districts.forEach((district, districtIndex) => {
                dates.forEach((date, dateIndex) => {
                    const rate = reportingRates[districtIndex][dateIndex];
                    const cellX = startX + dateIndex * cellWidth;
                    const cellY = startY + districtIndex * cellHeight;
                    
                    // Draw cell with color based on rate
                    ctx.fillStyle = getColorForRate(rate);
                    ctx.fillRect(cellX, cellY, cellWidth - 1, cellHeight - 1);
                    
                    // Add border
                    ctx.strokeStyle = '#ffffff';
                    ctx.lineWidth = 1;
                    ctx.strokeRect(cellX, cellY, cellWidth - 1, cellHeight - 1);
                    
                    // Add rate text inside cell
                    ctx.fillStyle = rate > 50 ? '#ffffff' : '#000000';
                    ctx.font = 'bold 12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(`${rate}%`, cellX + cellWidth/2, cellY + cellHeight/2 + 4);
                });
                
                // Y-axis labels (Districts)
                ctx.fillStyle = '#1e293b';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'right';
                const label = district.length > 18 ? district.substring(0, 15) + '...' : district;
                ctx.fillText(label, startX - 10, startY + districtIndex * cellHeight + cellHeight/2 + 5);
            });
            
            // X-axis labels (Dates)
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 13px Arial';
            ctx.textAlign = 'center';
            dates.forEach((date, dateIndex) => {
                ctx.save();
                ctx.translate(startX + dateIndex * cellWidth + cellWidth/2, startY + heatmapHeight + 25);
                ctx.rotate(-Math.PI/4);
                ctx.fillText(date, 0, 0);
                ctx.restore();
            });
            
            // Add grid lines for better readability
            ctx.strokeStyle = 'rgba(100, 116, 139, 0.2)';
            ctx.lineWidth = 0.5;
            
            // Horizontal grid lines
            for (let i = 0; i <= districts.length; i += 3) {
                const y = startY + i * cellHeight;
                ctx.beginPath();
                ctx.moveTo(startX, y);
                ctx.lineTo(startX + heatmapWidth, y);
                ctx.stroke();
            }
            
            // Vertical grid lines
            for (let i = 0; i <= dates.length; i += 2) {
                const x = startX + i * cellWidth;
                ctx.beginPath();
                ctx.moveTo(x, startY);
                ctx.lineTo(x, startY + heatmapHeight);
                ctx.stroke();
            }
            
            // Add data summary
            ctx.fillStyle = '#6b7280';
            ctx.font = '12px Arial';
            ctx.textAlign = 'right';
            ctx.fillText(`${districts.length} districts × ${dates.length} months`, canvasWidth - 10, canvasHeight - 10);
        }

        function drawLegend(ctx, centerX, y) {
            const legendWidth = 400;
            const legendHeight = 25;
            
            // Legend title
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Reporting Rate (%)', centerX, y - 5);
            
            const gradientStartX = centerX - legendWidth/2;
            const gradientY = y + 5;
            
            // Draw gradient bar
            for (let i = 0; i <= legendWidth; i++) {
                const ratio = i / legendWidth;
                const rate = ratio * 100;
                ctx.fillStyle = getColorForRate(rate);
                ctx.fillRect(gradientStartX + i, gradientY, 1, legendHeight);
            }
            
            // Legend border
            ctx.strokeStyle = '#64748b';
            ctx.lineWidth = 1;
            ctx.strokeRect(gradientStartX, gradientY, legendWidth, legendHeight);
            
            // Legend ticks and labels
            ctx.fillStyle = '#374151';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            
            const ticks = [0, 25, 50, 75, 100];
            ticks.forEach(tick => {
                const x = gradientStartX + (tick / 100) * legendWidth;
                
                // Tick mark
                ctx.strokeStyle = '#374151';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(x, gradientY + legendHeight);
                ctx.lineTo(x, gradientY + legendHeight + 8);
                ctx.stroke();
                
                // Tick label
                ctx.fillText(`${tick}%`, x, gradientY + legendHeight + 22);
            });
        }

        function getColorForRate(rate) {
            // Color scale from red (0%) to yellow (50%) to green (100%)
            if (rate <= 50) {
                // Red to yellow
                const ratio = rate / 50;
                const r = 255;
                const g = Math.round(ratio * 255);
                const b = 0;
                return `rgb(${r}, ${g}, ${b})`;
            } else {
                // Yellow to green
                const ratio = (rate - 50) / 50;
                const r = Math.round(255 * (1 - ratio));
                const g = 255;
                const b = 0;
                return `rgb(${r}, ${g}, ${b})`;
            }
        }

        // Generate the demo heatmap when page loads
        document.addEventListener('DOMContentLoaded', function() {
            generateDemoHeatmap();
        });
    </script>
</body>
</html>
